<!--
 * @Author: liaokt
 * @Description: 漏洞趋势图表组件
 * @Date: 2025-12-15
-->
<template>
  <a-card class="vulnerability-trend-chart">
    <template #title>
      <div class="vulnerability-trend-chart__header">
        <div class="vulnerability-trend-chart__title">漏洞趋势</div>
        <div class="vulnerability-trend-chart__subtitle">最近30天漏洞发现与修复情况</div>
      </div>
    </template>
    <div class="vulnerability-trend-chart__content">
      <MxChart
        type="line"
        :data="data"
        :config="{
          xField: 'date',
          yField: 'value',
          seriesField: 'type',
          options: {
            axis: {
              x: {
                title: '日期',
                labelFontSize: 12,
                labelFormatter: (d: string) => `${d}`
              },
              y: {
                title: '数量',
                labelFontSize: 12
              }
            },
            tooltip: {
              title: (d: any) => `日期: ${d.date}`,
              items: [{ field: 'value', name: '数量' }]
            },
            scrollbar: {
              x: {
                ratio: 0.2,
                trackSize: 8,
                trackFill: 'rgba(0, 0, 0, 0.06)',
                thumbFill: 'rgba(0, 0, 0, 0.2)',
                thumbFillHover: 'rgba(0, 0, 0, 0.3)'
              }
            }
          }
        }"
        :height="300"
      />
    </div>
  </a-card>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import { MxChart } from '@/components/MxChart'

/**
 * 漏洞趋势数据（最近30天）
 */
const data = ref([
  { date: '11-16', value: 12, type: '发现' },
  { date: '11-17', value: 8, type: '发现' },
  { date: '11-18', value: 15, type: '发现' },
  { date: '11-19', value: 10, type: '发现' },
  { date: '11-20', value: 18, type: '发现' },
  { date: '11-21', value: 14, type: '发现' },
  { date: '11-22', value: 20, type: '发现' },
  { date: '11-23', value: 16, type: '发现' },
  { date: '11-24', value: 22, type: '发现' },
  { date: '11-25', value: 19, type: '发现' },
  { date: '11-26', value: 25, type: '发现' },
  { date: '11-27', value: 21, type: '发现' },
  { date: '11-28', value: 17, type: '发现' },
  { date: '11-29', value: 23, type: '发现' },
  { date: '11-30', value: 19, type: '发现' },
  { date: '12-01', value: 15, type: '发现' },
  { date: '12-02', value: 11, type: '发现' },
  { date: '12-03', value: 13, type: '发现' },
  { date: '12-04', value: 9, type: '发现' },
  { date: '12-05', value: 7, type: '发现' },
  { date: '12-06', value: 10, type: '发现' },
  { date: '12-07', value: 6, type: '发现' },
  { date: '12-08', value: 8, type: '发现' },
  { date: '12-09', value: 12, type: '发现' },
  { date: '12-10', value: 9, type: '发现' },
  { date: '12-11', value: 11, type: '发现' },
  { date: '12-12', value: 7, type: '发现' },
  { date: '12-13', value: 5, type: '发现' },
  { date: '12-14', value: 8, type: '发现' },
  { date: '12-15', value: 6, type: '发现' },
  { date: '11-16', value: 5, type: '修复' },
  { date: '11-17', value: 7, type: '修复' },
  { date: '11-18', value: 4, type: '修复' },
  { date: '11-19', value: 8, type: '修复' },
  { date: '11-20', value: 6, type: '修复' },
  { date: '11-21', value: 9, type: '修复' },
  { date: '11-22', value: 7, type: '修复' },
  { date: '11-23', value: 10, type: '修复' },
  { date: '11-24', value: 8, type: '修复' },
  { date: '11-25', value: 12, type: '修复' },
  { date: '11-26', value: 9, type: '修复' },
  { date: '11-27', value: 11, type: '修复' },
  { date: '11-28', value: 13, type: '修复' },
  { date: '11-29', value: 10, type: '修复' },
  { date: '11-30', value: 14, type: '修复' },
  { date: '12-01', value: 12, type: '修复' },
  { date: '12-02', value: 15, type: '修复' },
  { date: '12-03', value: 11, type: '修复' },
  { date: '12-04', value: 13, type: '修复' },
  { date: '12-05', value: 16, type: '修复' },
  { date: '12-06', value: 14, type: '修复' },
  { date: '12-07', value: 17, type: '修复' },
  { date: '12-08', value: 15, type: '修复' },
  { date: '12-09', value: 18, type: '修复' },
  { date: '12-10', value: 16, type: '修复' },
  { date: '12-11', value: 19, type: '修复' },
  { date: '12-12', value: 20, type: '修复' },
  { date: '12-13', value: 18, type: '修复' },
  { date: '12-14', value: 21, type: '修复' },
  { date: '12-15', value: 22, type: '修复' }
])
</script>

<style lang="scss" scoped>
.vulnerability-trend-chart {
  border-radius: 8px;
  box-shadow: 0 2px 8px rgb(0 0 0 / 4%);

  &__header {
    display: flex;
    flex-direction: column;
    gap: 2px;
    min-height: 60px;
    padding: 8px 0;
  }

  &__title {
    font-size: 16px;
    font-weight: 600;
    line-height: 1.5;
    color: rgb(0 0 0 / 85%);
  }

  &__subtitle {
    font-size: 14px;
    font-weight: 400;
    line-height: 1.5;
    color: rgb(0 0 0 / 65%);
  }

  &__content {
    width: 100%;
  }
}

// 暗色主题适配
[data-theme='dark'] {
  .vulnerability-trend-chart {
    &__title {
      color: rgb(255 255 255 / 85%);
    }

    &__subtitle {
      color: rgb(255 255 255 / 65%);
    }
  }
}
</style>
